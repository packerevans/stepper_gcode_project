<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Arduino Terminal</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #111;
      color: #eee;
      margin: 0;
      padding: 20px;
    }
    h2 { text-align: center; }

    .control {
      margin: 20px auto;
      max-width: 400px;
      text-align: center;
    }
    input[type=range] { width: 80%; }
    button {
      margin: 10px;
      padding: 10px 20px;
      background: tan;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover { background: peru; }
    #log {
      background: #222;
      border: 1px solid #444;
      border-radius: 8px;
      padding: 10px;
      height: 300px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 14px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h2>Arduino Terminal</h2>

  <div class="control">
    <label>Arm Steps: <span id="armValue">3000</span></label><br>
    <input type="range" id="armSlider" min="0" max="10000" value="3000">
    <button onclick="sendCommand('ARM:' + document.getElementById('armSlider').value)">Send Arm</button>
  </div>

  <div class="control">
    <label>Base Steps: <span id="baseValue">3000</span></label><br>
    <input type="range" id="baseSlider" min="0" max="10000" value="3000">
    <button onclick="sendCommand('BASE:' + document.getElementById('baseSlider').value)">Send Base</button>
  </div>

  <div class="control">
    <button onclick="sendCommand('PAUSE')">Pause</button>
    <button onclick="sendCommand('RESUME')">Resume</button>
  </div>

  <div id="log">Loading logs...</div>

  <script>
    document.getElementById("armSlider").addEventListener("input", e => {
      document.getElementById("armValue").textContent = e.target.value;
    });
    document.getElementById("baseSlider").addEventListener("input", e => {
      document.getElementById("baseValue").textContent = e.target.value;
    });

    async function sendCommand(cmd) {
      await fetch("/send", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({command: cmd})
      });
    }

    async function fetchLogs() {
      const res = await fetch("/terminal/logs");
      const data = await res.json();
      document.getElementById("log").textContent = data.join("\n");
      document.getElementById("log").scrollTop = document.getElementById("log").scrollHeight;
    }

    setInterval(fetchLogs, 1000);
    fetchLogs();
  </script>
</body>
</html>
